name: Comment on Pull Request
on:
  pull_request:
    types: [opened]

jobs:
  post-comment:
    runs-on: ubuntu-latest
    permissions: write-all
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Check comment
        id: check-comment
        uses: peter-evans/find-comment@v2
        with:
          issue-number: ${{ github.event.pull_request.number }}
          body-includes: "Regras para deploy e convenÃ§Ã£o de nomenclatura da branch"
          token: ${{ secrets.GITHUB_TOKEN }}
     
      - name: Comment on Pull Request
        if: steps.check-comment.outputs.comment-id == ''
        uses: thollander/actions-comment-pull-request@v1
        with:
          message: |
            Regras para deploy e convenÃ§Ã£o de nomenclatura da branch.

            ### **ğŸŒ± Deploy para o ambiente de desenvolvimento:**
            - Para realizar o deploy no ambiente de **desenvolvimento**, comente no PR:  
              ```
              /deploy
              ```
            
            ### **ğŸ­ Deploy para o ambiente de produÃ§Ã£o (SemVer):**
            Utilizamos **[Versionamento SemÃ¢ntico (SemVer)](https://semver.org/lang/pt-BR/)** para controlar as versÃµes do repositÃ³rio.  
            Certifique-se de nomear a branch corretamente:

            | **Tipo de VersÃ£o**  | **Prefixo de Branch**  | **Exemplo**              |
            |--------------------|----------------------|--------------------------|
            | ğŸ **CorreÃ§Ã£o (Patch)** | `bugfix/`           | `bugfix/corrige-login`   |
            | âœ¨ **Nova feature (Minor)** | `feature/`         | `feature/novo-cadastro`  |
            | ğŸš€ **MudanÃ§a relevante (Major)** | `release/`         | `release/v2.0.0`        |
            | ğŸ“„ **Docs ou Ajustes** | `doc/` ou `misc/`   | `doc/atualiza-readme`    |

            **âš ï¸ Importante:**  
            - **Apenas branches corretas podem ser promovidas para produÃ§Ã£o**.  
            - VersÃµes sÃ£o incrementadas automaticamente com base no prefixo da branch.

            ğŸ”¹ _Se tiver dÃºvidas, fale conosco no discord!_  

          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}